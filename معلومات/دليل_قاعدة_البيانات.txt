# الدليل التقني لقاعدة بيانات نظام إدارة بلدية عين البيضاء

## 1. نظرة عامة على قاعدة البيانات

### هيكل قاعدة البيانات
قاعدة البيانات مبنية على نظام SQLite وتتكون من الجداول التالية:

1. جدول المستخدمين (users):
   - user_id: معرف المستخدم (مفتاح رئيسي)
   - username: اسم المستخدم
   - password: كلمة المرور (مشفرة)
   - role: نوع المستخدم (مدير/موظف)
   - last_login: آخر تسجيل دخول

2. جدول المواطنين (citizens):
   - citizen_id: معرف المواطن (مفتاح رئيسي)
   - full_name: الاسم الكامل
   - birth_date: تاريخ الميلاد
   - phone: رقم الهاتف
   - address: العنوان

3. جدول الطلبات (requests):
   - request_id: معرف الطلب (مفتاح رئيسي)
   - citizen_id: معرف المواطن (مفتاح خارجي)
   - request_type: نوع الطلب
   - status: حالة الطلب
   - request_date: تاريخ الطلب
   - completion_date: تاريخ الإنجاز

4. جدول الشكاوى (complaints):
   - complaint_id: معرف الشكوى (مفتاح رئيسي)
   - citizen_id: معرف المواطن (مفتاح خارجي)
   - subject: موضوع الشكوى
   - details: تفاصيل الشكوى
   - status: حالة الشكوى
   - priority: درجة الأهمية
   - submission_date: تاريخ التقديم

## 2. حماية قاعدة البيانات

### أ. التشفير والأمان
1. تشفير كلمات المرور:
   - استخدام خوارزمية BCrypt لتشفير كلمات المرور
   - عدم تخزين كلمات المرور بشكل نصي مباشر
   - استخدام Salt فريد لكل مستخدم

2. تشفير الاتصال:
   - استخدام بروتوكول SSL/TLS للاتصال بقاعدة البيانات
   - تشفير جميع البيانات المنقولة

### ب. النسخ الاحتياطي
1. النسخ اليومي التلقائي:
   - يتم إنشاء نسخة احتياطية يومياً في الساعة 23:00
   - حفظ النسخ في مجلد محمي
   - الاحتفاظ بنسخ آخر 30 يوم

2. استعادة البيانات:
   - إمكانية استعادة البيانات من أي نسخة احتياطية
   - التحقق من سلامة البيانات قبل الاستعادة

## 3. إدارة قاعدة البيانات

### أ. الصيانة الدورية
1. تنظيف البيانات:
   - حذف السجلات المؤقتة
   - تحسين أداء الاستعلامات
   - إعادة تنظيم الفهارس

2. تحديث الإحصائيات:
   - تحديث إحصائيات قاعدة البيانات
   - تحسين خطط الاستعلام

### ب. مراقبة الأداء
1. تتبع الأداء:
   - مراقبة زمن الاستجابة
   - تحليل الاستعلامات البطيئة
   - مراقبة استخدام الموارد

2. التحسين المستمر:
   - تحسين الاستعلامات
   - إضافة الفهارس المناسبة
   - تحسين هيكل الجداول

## 4. الخصائص التقنية

### أ. مكونات النظام
1. قاعدة البيانات:
   - نوع: SQLite 3
   - حجم الملف: يتم تحديثه تلقائياً
   - موقع الملف: مجلد التطبيق/data

2. واجهة البرمجة:
   - FireDAC للاتصال بقاعدة البيانات
   - معاملات (Transactions) للعمليات المهمة
   - معالجة الأخطاء والاستثناءات

### ب. الأداء والقدرات
1. معالجة البيانات:
   - دعم العمليات المتزامنة
   - تحسين الأداء للعمليات المتكررة
   - التعامل مع الأحمال العالية

2. حدود النظام:
   - عدد المستخدمين المتزامنين: غير محدود
   - حجم قاعدة البيانات: يعتمد على مساحة القرص
   - سرعة الاستجابة: > 100ms للاستعلامات العادية

## 5. إجراءات الأمان

### أ. التحكم في الوصول
1. صلاحيات المستخدمين:
   - مدير النظام: وصول كامل
   - موظف: وصول محدود
   - مراقب: قراءة فقط

2. تسجيل العمليات:
   - تسجيل جميع العمليات المهمة
   - تسجيل محاولات الدخول الفاشلة
   - تسجيل التغييرات في البيانات

### ب. الحماية من التهديدات
1. منع SQL Injection:
   - استخدام Prepared Statements
   - تحقق من المدخلات
   - تصفية البيانات

2. الحماية من الهجمات:
   - قفل الحساب بعد محاولات فاشلة
   - التحقق من صحة الجلسة
   - حماية من محاولات التخمين

## 6. الصيانة والدعم

### أ. الصيانة الدورية
1. المهام اليومية:
   - فحص سجلات الأخطاء
   - مراقبة حجم قاعدة البيانات
   - التحقق من النسخ الاحتياطي

2. المهام الأسبوعية:
   - تنظيف البيانات المؤقتة
   - تحديث الإحصائيات
   - فحص أداء النظام

### ب. حل المشكلات
1. مشاكل الاتصال:
   - فحص اتصال قاعدة البيانات
   - التحقق من صلاحيات المستخدم
   - فحص ملف قاعدة البيانات

2. مشاكل الأداء:
   - تحليل الاستعلامات البطيئة
   - تحسين الفهارس
   - تنظيف البيانات غير الضرورية

## 7. التطوير المستقبلي

### أ. التحسينات المخططة
1. تحسينات الأداء:
   - تحسين هيكل قاعدة البيانات
   - إضافة خاصية التخزين المؤقت
   - تحسين زمن الاستجابة

2. ميزات جديدة:
   - دعم التشفير الكامل للبيانات
   - إضافة واجهة API
   - دعم التكامل مع أنظمة أخرى
